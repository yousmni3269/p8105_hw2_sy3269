---
title: "p8105_hw2_sy3269.Rmd"
author: Soomin You 
date: 2024-09-25
output: github_document 
---

```{r setup, echo = FALSE, message = FALSE}
library(tidyverse)
library(readxl)
```

Required packages (e.g.`tidyverse` and `readxl`) are installed. 

# Problem 1 

Import and clean NYC subway data. Then convert the entry variable from character to a logical variable. 

```{r metro data}
metro_df = 
  read_csv("./NYC_Transit_Subway_Entrance_And_Exit_Data.csv",  na = c("NA", "", ".")) |>
  janitor::clean_names() |>
  select(line:route11, entry, vending, entrance_type, ada) |>
  mutate(
    entry = case_match(
      entry, 
      "YES" ~ TRUE,
      "NO" ~ FALSE
    ))

metro_df
```

The NYC metro data set contains line, station name, station location (latitude and longitude), routes served, entry and vending availability, entrance type, and ada compliance information. The data set was first imported and cleaned using a `janitor::clean_names` function. Then only the required variables were listed out to remove unnecessary information from the data set. The dimension of the data set is `r nrow(metro_df)` x `r ncol(metro_df)`. The data set is in human readable form but not yet tidy.  

```{r ada station}
unique_stn = distinct(metro_df, station_name, line, ada)
ada_stn = filter(unique_stn, ada == TRUE)
```

There are `r count(unique_stn)` distinct stations and there are `r count(ada_stn)` ADA compliant stations. 

```{r, no vending station}
nv_stn = filter(metro_df, vending == "NO")
nv_entry_stn = filter(nv_stn, entry == TRUE)
```

`r count(nv_entry_stn)` stations out of `r count(nv_stn)` stations without vending allow entrance. The proportion is about `r count(nv_stn)/count(nv_entry_stn)`. 

```{r, reformatting}
new_metro_df = 
  read_csv("./NYC_Transit_Subway_Entrance_And_Exit_Data.csv", na = c("NA", "", ".")) |>
  janitor::clean_names() |> 
  mutate(
    route7 = as.character(route7),
    route8 = as.character(route8),
    route9 = as.character(route9),
    route10 = as.character(route10),
    route11 = as.character(route11)
  ) |> 
  select(line, station_name, route1:route11, entry, vending, entrance_type, ada) |>
  pivot_longer( 
    cols = route1:route11,
    names_to = "route_number",
    values_to = "route_name",
    names_prefix = "route"
  )
```

The data set was reformatted so that `route number` and `route name` are distinct variables. 

```{r, station for A}
stn_for_A = distinct(new_metro_df, route_name == "A", ada) 
stn_for_A_ada = filter(stn_for_A, ada == TRUE)
```

There are `r count(stn_for_A)` stations that serve the A train and `r count(stn_for_A_ada)` of these stations are ADA compliant. 


# Problem 2 

Import and clean the Mr. Trash Wheel data. 

```{r, mr trash wheel}
mr_tw_df = read_excel(
  "./202309 Trash Wheel Collection Data.xlsx", sheet = "Mr. Trash Wheel", 
  skip = 1, 
  n_max = 584,
  na = c("NA", "", ".")) |>
  janitor::clean_names() |>
  mutate(
    sports_balls = as.integer(sports_balls),
    year = as.integer(year))

mr_tw_df = 
  select(mr_tw_df, -starts_with("x")) |> 
  mutate(trash_wheel_type = "mr_trash_wheel")
```

Similarly, import and clean Professor Trash Wheel and Gwynnda Trash Wheel. Then, combine with the Mr. Trash Wheel data set. 

``` {r professor and gwynnda}
prof_tw_df = 
  read_excel("./202309 Trash Wheel Collection Data.xlsx", sheet = "Professor Trash Wheel", 
  skip = 1, 
  n_max = 106, 
  na = c("NA", "", ".")) |>
  janitor::clean_names() |>
  mutate(
    sports_balls = NA, 
    trash_wheel_type = "professor_trash_wheel") 

gwyn_tw_df = read_excel(
  "./202309 Trash Wheel Collection Data.xlsx", sheet = "Gwynnda Trash Wheel", 
  skip = 1, 
  n_max = 154,
  na = c("NA", "", ".")) |>
  janitor::clean_names() |>
  mutate(
    glass_bottles = NA,
    sports_balls = NA, 
    trash_wheel_type = "gwynnda_trash_wheel")

comb_tw_df = bind_rows(prof_tw_df, gwyn_tw_df, mr_tw_df)
```

To combine the data sets into one, I added two additional columns for glass bottles and sports balls to `gwyn_tw_df` data set and one column for sports balls to `prof_tw_df` data set. 
Then, for all three types of data set, I added a new variable named `trash_wheel_type` to keep track of which trash wheel data is which. 

```{r, data summary}
trash_types = 
  select(comb_tw_df, plastic_bottles:sports_balls) |>
  names()

wgt_prof_tw_df = 
  select(prof_tw_df, weight_tons) |>
  sum()

wgt_gwyn_tw_df = select(gwyn_tw_df, weight_tons) |>
  sum()

wgt_mr_tw_df = select(mr_tw_df, weight_tons) |>
  sum()

cb_comb_tw_df = 
  comb_tw_df |>
  select(cigarette_butts) |>
  sum()
  
cb_gwyn_tw_df = 
  gwyn_tw_df |>
  filter(year == 2022, month == "June") |>
  select(cigarette_butts) |>
  sum()
```

In a data set where Professor Trash Wheel, Gwynnda Trash Wheel and Mr. Trash Wheel data all combined, there are total `r nrow(comb_tw_df)` observations, where `r nrow(prof_tw_df)`, `r nrow(gwyn_tw_df)`, and `r nrow(mr_tw_df)` observations came from each respective data set. 
There are `r length(trash_types)` types of trash collected by the Trash Wheels and they are as follows: `r trash_types`. 

The total weight of trash collected by Professor Trash Wheel is `r wgt_prof_tw_df` tons whereas Gwynnda Trash Wheel and Mr. Trash Wheel collected `r wgt_gwyn_tw_df` tons and `r wgt_mr_tw_df` tons, respectively. 

The total number of cigarette butts collected by three Trash Wheels are `r cb_comb_tw_df` and Gwynnda collected `r cb_gwyn_tw_df` cigarette butts in June of 2022. 


# Problem 3


